<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Simon Spavound" />

<meta name="date" content="2018-06-22" />

<title>exuber package</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">exuber package</h1>
<h4 class="author"><em>Simon Spavound</em></h4>
<h4 class="date"><em>2018-06-22</em></h4>



<p>WARNING: THIS VIGNETTE IS CURRENTLY WORK IN PROGRESS AND SUBJECT TO CHANGE.</p>
<p>This vignette documents how to use the exuber package for analysing time series data.</p>
<p>Let’s start by loading the package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(exuber)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a></code></pre></div>
<div id="the-radf-function" class="section level2">
<h2>The <code>radf()</code> function</h2>
<p>The <code>radf()</code> function is the main workhorse function of the exuber package. It implements the recursive augmented Dickey-Fuller (hence radf) tests proposed in PWY (2011) and PSY (2015). It takes three arguments:</p>
<ul>
<li>x</li>
<li>minw</li>
<li>lag</li>
</ul>
<p><code>x</code> is a univariate or multivariate numeric object containing the data series for testing. It can be a ts object, data.frame or matrix. Due to the nature of the recursive procedure applied the series must be continuous and not contain missing values. <code>minw</code> is the minimum window size used during the estimation. If the minimum windows size is equal to the number of observations the test is merely the ADF test as all data is used. PSY (2015) (find precise referenceincluding page) suggest a rule of thumb which is that the fraction of the observations included in the minimum window should be equal to <code>0.01 + 1.8/sqrt(T)</code> where <code>T</code> is the sample size. This is the default option in the radf() function. Finally <code>lag</code> allows you to select the appropriate lag specification in the ADF regression.</p>
</div>
<div id="creating-simulated-data-which-incorporate-rational-bubbles" class="section level2">
<h2>Creating simulated data which incorporate rational bubbles</h2>
<p>The exuber package has numerous functions which allow the creation of time series which incorporate rational bubble models. These include <code>sim_dgp1()</code>, which generates a time series with a single episode of explosive behaviour, <code>sim_dgp2()</code> which generates a time series with two episodes of explosive behaviour. Two rational bubble models are also currently included; <code>sim_blan()</code> which generates a time series containing rational bubbles as proposed by Blanchard (1979). The final function, <code>sim_evans()</code> generates a periodically collapsing rational bubble model series. It is the latter type of bubbles that the GSADF test that PSY attempts to detect.</p>
<p>To test the GSADF test and its associated date-stamping strategy, the BSADF test, PSY utilise a model of dividends and incorporate an Evans (1991) type bubble. We replicate that here to show 1) the ability of exuber to generate realistic simulated time series which incorporate bubbles and 2) to demonstrate the capabilities of <code>radf()</code> to detect them.</p>
<p>Lets start be generating a realistic prices series incorporating an Evans (1991) type periodically collapsing bubble. We will use the monthly parameterisation detailed in PSY (2015a), which corresponds to the empirical values from the S&amp;P 500 (see later example). exuber contains a function <code>sim_div()</code> which can be used to generate simulated dividends streams from a random walk with drift model.</p>
<p>Need to make all of these clearer and more consistent with either Evans or Phillips (i.e., need to make a decision)</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># need to add explanation for what each of these is</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># n &lt;- the sample size</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">n &lt;-<span class="st"> </span><span class="dv">400</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">mu &lt;-<span class="st"> </span><span class="fl">0.0024</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co"># this is the value of sigma squared in the paper need to check if code takes sigma (i.e. do i need to take sqroot)</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6">sigma &lt;-<span class="st"> </span><span class="fl">0.0010</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">rho &lt;-<span class="st"> </span><span class="fl">0.985</span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># check this is the correct understanding of rho to r transformation</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>rho</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co"># the value which the bubble returns to when it collapses</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11">delta &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12">b1 &lt;-<span class="st"> </span><span class="fl">0.50</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">pi &lt;-<span class="st"> </span><span class="fl">0.85</span></a>
<a class="sourceLine" id="cb2-14" data-line-number="14">xi &lt;-<span class="st"> </span><span class="fl">0.5</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15"><span class="co"># the scaling factor for the bubble</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16">kap &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17"><span class="kw">set.seed</span>(<span class="dv">123</span>) <span class="co"># find a nice seed for illu purposes</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co"># The fundamental value from the Lucas pricing model</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">pf &lt;-<span class="st"> </span><span class="kw">sim_div</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co"># the evans bubble term</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21">b &lt;-<span class="st"> </span><span class="kw">sim_evans</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co"># the simulated time series</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23">p &lt;-<span class="st"> </span>pf <span class="op">+</span><span class="st"> </span>kap<span class="op">*</span>b</a>
<a class="sourceLine" id="cb2-24" data-line-number="24">  </a></code></pre></div>
<p>We can now plot this data to see what it looks like:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">plot</span>(p, <span class="dt">xlab =</span> <span class="st">&quot;&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" width="80%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="co"># need to add actual plot below it to show it looks similar to PSY(2015)</span></a></code></pre></div>
<p>As we can see it looks very typical for the kind of data we wish to analyse with some peaks and troughs which may be indicative of explosive sub-periods. Let us conduct a more formal analysis:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">test &lt;-<span class="st"> </span><span class="kw">radf</span>(p)</a></code></pre></div>
<p>Then we must generate critical values. The exuber package contains two methods of generating critical values, <code>mc_cv()</code> which generates monte carlo critical values. And <code>wb_cv()</code> which generates critical values as in Sollis et al. <code>mc_cv()</code> merely requires the length of the series and the minimum window size</p>
</div>
<div id="load-data" class="section level2">
<h2>Load data</h2>
<p>We now demonstrate the ability of the exuber package to detect bubbles in real data by replicating the empirical example of Philips, Shi and Yu (2015). They apply recursive unit root testing methods to the S&amp;P 500 Price Dividend ratio.</p>
<!-- this will need a lot of modification once I have worked out how to correctly attach the data file -->
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">dta &lt;-<span class="st"> </span>sp500 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(Date, Ratio)</a></code></pre></div>
<p>Lets have a look at the data:</p>
<!-- need to read up how to correctly format these graphs -->
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">ggplot</span>(sp500, <span class="kw">aes</span>(<span class="dt">y =</span> Ratio, <span class="dt">x =</span> Date)) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>()</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="run-radf" class="section level2">
<h2>Run RADF()</h2>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">testSP500 &lt;-<span class="st"> </span><span class="kw">radf</span>(sp500 <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">select</span>(PVratio))</a></code></pre></div>
</div>
<div id="calculate-critical-values" class="section level2">
<h2>Calculate Critical Values</h2>
<p>WARNING: This will take a long time to evaluate, even on very fast computers with many cores. It is recommended for testing purposes that you reduce number of repetitions (nrep) to something small, i.e. 10.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">critSP500 &lt;-<span class="st"> </span><span class="kw">mc_cv</span>(<span class="kw">NROW</span>(sp500), <span class="dt">nrep =</span> <span class="dv">2000</span>, <span class="dt">parallel =</span> T)</a></code></pre></div>
</div>
<div id="report" class="section level2">
<h2>Report</h2>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">report</span>(testSP500, critSP500)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3"><span class="co">#&gt;  Recursive Unit Root Testing Summary </span></a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="co">#&gt;  --------------------------------------------- </span></a>
<a class="sourceLine" id="cb10-5" data-line-number="5"><span class="co">#&gt;  H0: Unit root  </span></a>
<a class="sourceLine" id="cb10-6" data-line-number="6"><span class="co">#&gt;  H1: Explosive root </span></a>
<a class="sourceLine" id="cb10-7" data-line-number="7"><span class="co">#&gt;  ---------------------------------------------</span></a>
<a class="sourceLine" id="cb10-8" data-line-number="8"><span class="co">#&gt;  Critical values are generated by: Monte Carlo </span></a>
<a class="sourceLine" id="cb10-9" data-line-number="9"><span class="co">#&gt;  Number of iterations: 2000 </span></a>
<a class="sourceLine" id="cb10-10" data-line-number="10"><span class="co">#&gt;  Minimum window is set to: 90 </span></a>
<a class="sourceLine" id="cb10-11" data-line-number="11"><span class="co">#&gt;  Lag is set to: 0 </span></a>
<a class="sourceLine" id="cb10-12" data-line-number="12"><span class="co">#&gt;  ---------------------------------------------</span></a>
<a class="sourceLine" id="cb10-13" data-line-number="13"><span class="co">#&gt;  PVratio </span></a>
<a class="sourceLine" id="cb10-14" data-line-number="14"><span class="co">#&gt;           tstat        90%        95%      99%</span></a>
<a class="sourceLine" id="cb10-15" data-line-number="15"><span class="co">#&gt; ADF   -1.120363 -0.4561808 -0.1151894 0.686780</span></a>
<a class="sourceLine" id="cb10-16" data-line-number="16"><span class="co">#&gt; SADF   3.443243  1.2904329  1.5861064 2.124151</span></a>
<a class="sourceLine" id="cb10-17" data-line-number="17"><span class="co">#&gt; GSADF  4.206874  2.2113999  2.3932936 2.882003</span></a></code></pre></div>
<p>This should result in an output like this:</p>
</div>
<div id="plot" class="section level2">
<h2>Plot</h2>
<!-- see issue tracker cannot modify x labels -->
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="kw">plot</span>(testSP500, critSP500, <span class="dt">breaks_x =</span> <span class="st">&quot;10 years&quot;</span>, <span class="dt">format_date =</span> <span class="st">&quot;%Y&quot;</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAB8lBMVEUAAAAAADoAAGYAAP8AOjoAOmYAOpAAZpAAZrYwMO8zMzM6AAA6ADo6OgA6OmY6ZmY6kNtNTU1NTVlNTV5NTWNNTWRNTW5NTW9NTY5NY25NaX9NaatNbqtNeXlNechNg45NjqJNjshTTU1TTW9TTYNUVONZTU1ZTVlZTWRZTY5eTU1eTW9eTY5eZH9eneRjTY5jWU1kTU1kTY5kq+RmAABmOgBmOmZmkNtmtttmtv9pTU1pTY5uTU1uTVluTV5uTWRuTW5uTW9uTXluTY5uaX9ubo5ubqtunZ1uq8huq+RvTV5vTW9voqt5TU15eU15yP9/aU2DTU2DTVODjm6OTU2OTV6OTWmOTW6OTW+OTY6Obk2ObquOeU2OtauOyKuOyMiOyP+O5P+QOgCQZgCQZmaQkLaQttuQ2/+dnW6iZE2ijk2i//+raU2raV6rbk2rbmOrbm6rbo6rjk2rtX+rtY6ryI6ryKurzaur5Mir5OSr5P+1//+2ZgC2tpC2ttu22/+2///Ig03Ijk3IyI7I5KvI///bkDrbtmbb29vb/7bb/9vb///j4+Pkjlnkq27k5Kvk///vMDDv7+//AAD/omT/tW7/tmb/yHn/yIP/yI7/zX//25D/27b/5I7/5J3/5Kv//6L//7b//8j//9v//+T///9H4CQkAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAM2UlEQVR4nO3diZ8URxUA4EmeiTR47IhZMOKxGqNRPECiYlZFozGrxhNFVHRFTTwRb1nRJCtDVOLI9gq6YBwZ9v2f1t1VXdVV0zM9s3O8lx87092v6lV/W13TLKFpIUU0Wns9gGkPAkoEASWCgBJBQIkgoEQQUCIIKBGDA11tibjvabxz4v5rYtfd8/c+V067/YHn2H6VMAdRG6jVOsnenhS77pzY56fdu7BAcra80Lr/2u0DEuamggqkzU3UBsLL7PWyfM9e7p7fd7V177P4witbrXs+yOYOm2JLcgb959FW675nxzLqCcZwQDdbSyivsLvnX3aAzSl1/Z20gG4e4HvueWZMA59UDHGJ7UO1yPArjIksidWaTRVx5ek1iB34EF+4Zn01qr9IizlxlX+9yk7efJD95Y/fP9CygNQ6dXnWp1BtoFeJVeXOiSXGsKTnEps84qADJBbwmwsE5Hw8sZXo9iue0UB3TrRe/YM//fUEAZlg58+vMAUkNZw1aAEvMQfo7vmXf28JC6B91/jHOnvPV6cFXaTdO8CbcrWWQOLTnQUHWvSPeR3qN2RqkRY3hU/zW6Q7j7b2/U1OqwW7UVzQIKBEEFAiCCgRBJQIAkoEASWCgBIxMFBr/4JFbSDrfZ5jbt6Hkp2deTmlvCP3MmKRi3T9C1+M1g4WzK2oHBQBEVBlQQLym3g9EFCkIAH5TbweCChSkID8Jl4PBBQpqGwyAqooSEB+E68HxkNAVQUbBNq9sK7fElAoum0Cio2l96lvEFBkKLsXL8lLjP94hID86K7RGhQD6j1xnYBiQN02j7VAIgHpmO8ZlBFQuGCDQFbMI1BGQMGCBOQ38XogoEhBAvKbeD0QUKQgAflNvB4IKFKQgPwmXg8EFClIQH4TrwcCihSUQBkBVRUkIL+J1wMBRQoSkN/E64GAIgUJyG/i9UBAkYIE5DfxeiCgSEEC8pt4PRBQpKDxIaBwQQLym3g9EFCkIAH5TbweCChSUAHlBFRRkID8Jl4PBBQpSEB+k3IPGQFFChKQ36TcAwHFChKQ36Tcg7xLJKBwQQLym5R7mD0gGHQcBJQKAkoEASWCgBJBQIkgoEQQUCIIKBEElIjhgMDZJCCvIAGFa5uCBBSubQoSULi2KRgGyghIFySgcG1TcJGAssaAcgIyBQkoXNsUJKBwbVOQgMK1dQEgoHBtXYCAKmrrAuMB6q22J/aQt1kE6p/ZwN6pjUAiAYnYWWFfNtcDiQRkgs+iiTwFb0aBdi/oR5jRDApF/7TxaRQoK23PKlBvdb3YICAvHB8C8kM+R3Ecn2I+EMwikBsuEBBQOeYNKCcguwABVdTWBQJA+fwCZQQUCwJKBAElgoAS0QxQTkBOAQKqqK0LEFBFbV2AgCpq6wIEVFFbFyCgitq6AAFV1NYFSkAZAZUKTBgoIyA/CCgRBJSI+QTKrJ1uGwIiILvAAgJlIwBlYwfK9hAoI6B4EFAiNBAQUDgaAcoJyC0wW0AZAc0kkDsEAiIgu8DiAWW1gLJZA3LHQkClowRUGyirA5QvJNDg/x9wJk6LgCrDAuKnNwhQRkBVtU1BAgrXNgUXEigjoFCkgLJAk2ogs5+ArHrzDwRjAMrmEQgIyA8FlA8PZHzmGAgiQH5PUwjk/kGmP143e/GAsskA5QEgqAOUE5AuSEA6CGhMQOVBjQyku7PX46IaAdUCKg2ZgAhob4HyWQDKZhkoJyCv4GwDZQpoIKQpAuqfbh+5joFEGygbP5C7exigfCxAuxfWsbuCgUQCEtE/28He451AIgGJ6D1xveIhbwQkYueIBionukBFx+MBgmkFKmZQObF5IBweqNQoDITjAKpcg7a3tra3tre3ZccA2yr0KLbFUXWcZWzp4yq2tsrbW6X2znFwt7Ocp/NfGsg5zoBK7cV4S/VEaCBxkOXUBeIPUQx+ik0V0NtGBoJhgQa9DxLvii9yp5vt9tvQJQYaSOfJr5k7FNkkdolBcFCN3UlLIBgFKBsNSB8eEAhKQGCAnDbzAgRTCoTNAcEoQFAXCBYRCHRH4qsCchedaiAYE1DuAEFNIJuCA+UjAJnjagwJIJgIUD4aUD4UEOjWGihPABXDiQOBGuUEgIqddnYCCIYEEn/DAF6sAoLCSBbU+0tASEDTCGSfa2NA+mz5aeUKCKcRCPYcCEH+vfkhgHi9mQKCkYH0gQQQVAMBzgMQxIGkAO8N1AYUN4HVQGJqNQ0k1yC9Zo4RyJ4ZdYEwCAQlIHXtsf/2Bkhf3YMBwaBAuQcEJSCJASEgDAFBs0B5EAg8IGgCCFwgyANAgmLagWBWgNABKgbRMBC6QNooDmSNty4QOEDoA4EBgggQBoGw4TXIAIEA0kMz3+tqICiAoDaQzHGA0AWCGJApmgeAyn/y0RSQGE8aSJeuBwSDA2ESCBJAeekfP2kASI4nrwEEFUB5FRCMCoSm4EBA1gAmBAQRILP2Dg+EZSCMA0EcCBoGAglkTeg0EEwOSH6s2UAwUSBl4gPxU64AwqGB1BUUBwIXSJZ0gHDvgNAMoBII4kBQCQRo/e4qDIQDAenhh4GcVbo5ID0KM4UrgMB8E8NAxSVa+LhzpxoIy0BFJ3WA7Gjk31nVQN4ZVQKhBrIWrDIQ6F9gnbm6UQ4CFdUFEJaBQD2RdPJAYs10geQsyX0g8IDMxMs9IAgAYQIIK4BgT4GwEsisr/ImHjwgzRABKiaS9TmYBrJXe7FvWoAwBMRvlNEDwiGB4jNINPWAAPIZAdKDzHLNAFEgvRzZdwARIAwBqUm3d0DuX4eygcAA5YbHAsIAEIaBnIgAyeNlIJw2IHCAwAeCEhCGgKAKCOcECF0gtIGsH1OBDwQ2EMwlEHpAbob1YyoxZhtI/+StQSDv5PcQCB0gCADxE44CgQPk/gjCnF4CqNxmioDUahMDwhhQEej8PLF0ehGg8HMUvR72DAgLIEgDYRUQzi8Q1gLSA7aB0AbyY/aB5E5z8zwMkL5UQzEvQGhW7IGB0HyGzTVQsdPc5sTHq4DMT/FR/xYsPJC5AsIhgBDN/WIw5ghInXJ9IKtxoO8FBaoW8VrPD1C4NAENCTRgEFAiCCgRBJQIAkoEASWCgBJBQImYWqBS7K+5PXpC8z3GEmoDlWN/ze3RE5rvMZ1AQIkEAkokjAC0KEFAiSCgRBBQIggoEfWAxPOWeqvtw+rlCt++9Zbgtni4Dm/Q+/gxsYM3LzVor9sJO223B/4Io3PWdretEnSD3Qvt5d8VCfx4u33OSgiM8dAxVhV7n3hKPPqHDbLNt/Glh9WjgNQjpcyTpWoB7fAq/Kld3SPX+cvf+fa/2Be+fXrd2RYPGXwDe89O+wu8AW/+gN2AddD7iJXAx2T3gILE2t5cl0MwPbId/3Qb4M7rrITAGPtffv313qlfi4QVJvydMz9c6Z3a+DdPWNGnaF5qAm0u/5Z/d/ijzc522MvmA5893tk8+O7HOnr7M0fV9pkN/oCv51/z7cd/vPyrt/5BqG4uf4ttm4QdNp7N9uesBLZ98F3HTQL7Nr6PHTfbuxc3xBBMA1ZCDKlogP2n7AR3jGJ7580s70fLv3nHT/gk6Z/98wp72fz8a0+9t8O/QfIU9UvtGSQmnjWDug8+xra/epR/d4Qbe4u9T+rBsFR+Adwy5y8vMZXA+ysnYPdNVsLuxUviElPb4nIQ1+Qtff6/lJdY0SObBVaCGaMzJr7b9MB3/J69MT2MdInJZurJXfzlH3xbXr78EuseZED90490ussb8iGDfPgvPcym83IBpBJQPCWtZyf0VsX56oTumlyD1Da7EpiZ1WNvdV2cetGjuGytHvUYVYIY4/KlC2t445AAEoP82hfXcOfB5oD4OHcOd8TLoeNs+6NHO2ybL4BP/owB8QXxyYvWDOIrJtuB9iIttvun17DnJMg5WPRQLNLqOG6eKxqYSWsS+AlbPZox6gQ+xp+vriFaM+h/x96D2OQMUs+fFC98dAU+9r/OByOu7Y58yKC4pPi38GynAJIJyCeAPB2TgPj8IyZBfig9VDQogGSD/jc1kE7YXHN6NGO0euCTi33Va1Cnt8or9s/INWiMM0hc73wFEWvSinrIoJjvb/+uetygusRkgvBBK8GcjkpA/TGvtvnx3V9csXrc1JeYasCXcbtHM0aVwOfMh9/IO/7vO98vP8U+vfoVXmn3pw919BhHBeK3K/x65y/iJuSG2ZZrEtvWa5S8D/pY29xjXCkSrLsWldC1epQN1CV2ozi+YffIShy+Ypc8o4B0wk6px522jHVzH/Qlud3QfdAiBgElgoASQUCJIKBEEFAiCCgRBJQIAkoEASWCgBJBQIkgoEQQUCIIKBEElAgCSgQBJYKAEkFAiSCgRBBQIggoEQSUCAJKBAEl4v8ufQ74cQslvAAAAABJRU5ErkJggg==" width="80%" style="display: block; margin: auto;" /></p>
<!-- need to investigate including a fomal reference section here -->
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
